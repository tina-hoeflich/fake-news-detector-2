<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake News Detection - Dashboard</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: #0f0f0f;
            color: #e0e0e0;
            min-height: 100vh;
            padding: 2rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #333;
        }
        
        h1 {
            font-size: 2rem;
            font-weight: 300;
            color: #fff;
            margin-bottom: 0.5rem;
        }
        
        h1 span {
            color: #ff6b6b;
            font-weight: 600;
        }
        
        .subtitle {
            color: #888;
            font-size: 0.9rem;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .stat-number.high { color: #ff6b6b; }
        .stat-number.medium { color: #ffd93d; }
        .stat-number.low { color: #6bcb77; }
        .stat-number.total { color: #4ecdc4; }
        
        .stat-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #888;
        }
        
        .upload-section {
            background: #1a1a1a;
            border: 2px dashed #333;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
            transition: border-color 0.3s;
        }
        
        .upload-section:hover {
            border-color: #555;
        }
        
        .upload-section input {
            display: none;
        }
        
        .upload-section label {
            cursor: pointer;
            display: block;
        }
        
        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            background: #1a1a1a;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .results-table th,
        .results-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #333;
        }
        
        .results-table th {
            background: #252525;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #888;
        }
        
        .results-table tr:hover {
            background: #252525;
        }
        
        .claim-text {
            max-width: 400px;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .risk-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .risk-badge.high {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }
        
        .risk-badge.medium {
            background: rgba(255, 217, 61, 0.2);
            color: #ffd93d;
        }
        
        .risk-badge.low {
            background: rgba(107, 203, 119, 0.2);
            color: #6bcb77;
        }
        
        .factcheck-link {
            color: #4ecdc4;
            text-decoration: none;
            font-size: 0.85rem;
        }
        
        .factcheck-link:hover {
            text-decoration: underline;
        }
        
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #666;
        }
        
        .empty-state p {
            margin-bottom: 1rem;
        }
        
        .score-bar {
            width: 60px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .score-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s;
        }
        
        .score-fill.high { background: #ff6b6b; }
        .score-fill.medium { background: #ffd93d; }
        .score-fill.low { background: #6bcb77; }
        
        footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #333;
            color: #555;
            font-size: 0.8rem;
        }
        
        @media (max-width: 768px) {
            .results-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Fake News <span>Detection</span></h1>
            <p class="subtitle">MVP Dashboard - Ergebnisse visualisieren</p>
        </header>
        
        <div class="stats" id="stats">
            <div class="stat-card">
                <div class="stat-number total" id="total-count">0</div>
                <div class="stat-label">Gepr√ºft</div>
            </div>
            <div class="stat-card">
                <div class="stat-number high" id="high-count">0</div>
                <div class="stat-label">Hohes Risiko</div>
            </div>
            <div class="stat-card">
                <div class="stat-number medium" id="medium-count">0</div>
                <div class="stat-label">Pr√ºfen</div>
            </div>
            <div class="stat-card">
                <div class="stat-number low" id="low-count">0</div>
                <div class="stat-label">Niedrig</div>
            </div>
        </div>
        
        <div class="upload-section">
            <input type="file" id="file-input" accept=".json,.csv">
            <label for="file-input">
                <div class="upload-icon">üìÅ</div>
                <p>JSON oder CSV Datei hierher ziehen oder klicken</p>
                <p class="subtitle">Ergebnisse aus der Pipeline laden</p>
            </label>
        </div>
        
        <div id="results-container">
            <div class="empty-state">
                <p>Noch keine Daten geladen</p>
                <p class="subtitle">Lade eine Ergebnis-Datei um die Analyse zu sehen</p>
            </div>
        </div>
        
        <footer>
            Fake News Detection MVP ‚Ä¢ Iterativ erweiterbar
        </footer>
    </div>
    
    <script>
        let results = [];
        
        // File Upload Handler
        document.getElementById('file-input').addEventListener('change', handleFile);
        
        // Drag & Drop
        const uploadSection = document.querySelector('.upload-section');
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.style.borderColor = '#4ecdc4';
        });
        uploadSection.addEventListener('dragleave', () => {
            uploadSection.style.borderColor = '#333';
        });
        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.style.borderColor = '#333';
            if (e.dataTransfer.files.length) {
                handleFile({ target: { files: e.dataTransfer.files }});
            }
        });
        
        function handleFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const content = e.target.result;
                
                if (file.name.endsWith('.json')) {
                    results = JSON.parse(content);
                } else if (file.name.endsWith('.csv')) {
                    results = parseCSV(content);
                }
                
                renderResults();
            };
            reader.readAsText(file);
        }
        
        function parseCSV(content) {
            const lines = content.split('\n');
            const headers = lines[0].split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                const values = lines[i].split(',');
                const row = {};
                headers.forEach((h, idx) => {
                    row[h.trim()] = values[idx]?.trim() || '';
                });
                data.push(row);
            }
            return data;
        }
        
        function renderResults() {
            // Update Stats
            const total = results.length;
            const high = results.filter(r => r.risk_category?.includes('HOHES') || r.risk_category?.includes('HIGH')).length;
            const medium = results.filter(r => r.risk_category?.includes('PR√úFEN') || r.risk_category?.includes('MEDIUM')).length;
            const low = results.filter(r => r.risk_category?.includes('NIEDRIG') || r.risk_category?.includes('LOW')).length;
            
            document.getElementById('total-count').textContent = total;
            document.getElementById('high-count').textContent = high;
            document.getElementById('medium-count').textContent = medium;
            document.getElementById('low-count').textContent = low;
            
            // Render Table
            const container = document.getElementById('results-container');
            
            if (results.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>Keine Ergebnisse</p></div>';
                return;
            }
            
            let html = `
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Claim</th>
                            <th>Risiko</th>
                            <th>Score</th>
                            <th>Fact-Check</th>
                            <th>Quelle</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            results.forEach(r => {
                const riskClass = r.risk_category?.includes('HOHES') || r.risk_category?.includes('HIGH') ? 'high' 
                    : r.risk_category?.includes('PR√úFEN') || r.risk_category?.includes('MEDIUM') ? 'medium' 
                    : 'low';
                
                const score = parseFloat(r.risk_score) || 0;
                
                html += `
                    <tr>
                        <td class="claim-text">${escapeHtml(r.claim_text?.substring(0, 150))}${r.claim_text?.length > 150 ? '...' : ''}</td>
                        <td><span class="risk-badge ${riskClass}">${r.risk_category?.replace(/[üî¥üü°üü¢]/g, '').trim() || 'N/A'}</span></td>
                        <td>
                            <div class="score-bar">
                                <div class="score-fill ${riskClass}" style="width: ${score * 100}%"></div>
                            </div>
                            <small style="color:#888">${(score * 100).toFixed(0)}%</small>
                        </td>
                        <td>${r.has_existing_factcheck === 'True' || r.has_existing_factcheck === true 
                            ? `<a href="${r.factcheck_url}" target="_blank" class="factcheck-link">${r.factcheck_rating || 'Link'}</a>` 
                            : '<span style="color:#666">‚Äî</span>'}</td>
                        <td><a href="${r.source_url}" target="_blank" class="factcheck-link" style="font-size:0.75rem">${new URL(r.source_url || 'https://unknown').hostname}</a></td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
        
        function escapeHtml(text) {
            if (!text) return '';
            return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }
        
        // Demo-Daten f√ºr Vorschau
        const demoData = [
            {
                claim_text: "Laut einer neuen Studie sind 95% aller Statistiken erfunden",
                risk_category: "üî¥ HOHES RISIKO",
                risk_score: 0.75,
                has_existing_factcheck: true,
                factcheck_rating: "Falsch",
                factcheck_url: "#",
                source_url: "https://example.com/article"
            },
            {
                claim_text: "Die Regierung plant neue Ma√ünahmen zur Energiewende bis 2030",
                risk_category: "üü¢ NIEDRIG",
                risk_score: 0.15,
                has_existing_factcheck: false,
                source_url: "https://serioes.de/news"
            },
            {
                claim_text: "Experten warnen: Diese Technologie wird alle Jobs vernichten",
                risk_category: "üü° PR√úFEN",
                risk_score: 0.45,
                has_existing_factcheck: false,
                source_url: "https://clickbait.net/tech"
            }
        ];
        
        // Lade Demo-Daten f√ºr Vorschau
        // results = demoData;
        // renderResults();
    </script>
</body>
</html>
